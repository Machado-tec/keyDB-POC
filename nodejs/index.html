<!DOCTYPE html>
<html>
<head>
  <title>KeyDB Log</title>
</head>
<body>
  <h1>Real-time Log of KeyDB Updates</h1>
  <div id="log1">keydb_01: No updates yet.</div>
  <div id="log2">keydb_02: No updates yet.</div>
  <div id="log3">keydb_03: No updates yet.</div>
  
  <!-- Buttons for each KeyDB instance -->
  <button id="interval-btn-01">Update Interval (keydb_01): 10 seconds</button>
  <button id="interval-btn-02">Update Interval (keydb_02): 10 seconds</button>
  <button id="interval-btn-03">Update Interval (keydb_03): 10 seconds</button>

  <script>
    const eventSource = new EventSource('/events');
    
    eventSource.onmessage = function(event) {
      const data = event.data;
      if (data.startsWith('keydb_01')) {
        document.getElementById('log1').innerHTML = data;
      } else if (data.startsWith('keydb_02')) {
        document.getElementById('log2').innerHTML = data;
      } else if (data.startsWith('keydb_03')) {
        document.getElementById('log3').innerHTML = data;
      }
    };

    // Handle button clicks to change the update interval for each keydb
    const intervalBtn01 = document.getElementById('interval-btn-01');
    intervalBtn01.onclick = function() {
      fetch('/change-interval/keydb_01', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
          intervalBtn01.textContent = `Update Interval (keydb_01): ${data.newInterval} seconds`;
        });
    };

    const intervalBtn02 = document.getElementById('interval-btn-02');
    intervalBtn02.onclick = function() {
      fetch('/change-interval/keydb_02', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
          intervalBtn02.textContent = `Update Interval (keydb_02): ${data.newInterval} seconds`;
        });
    };

    const intervalBtn03 = document.getElementById('interval-btn-03');
    intervalBtn03.onclick = function() {
      fetch('/change-interval/keydb_03', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
          intervalBtn03.textContent = `Update Interval (keydb_03): ${data.newInterval} seconds`;
        });
    };
  </script>
</body>
</html>